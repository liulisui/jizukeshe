00000000 10100000    ; LDI  R0      ; 初始化当前时间值为0
00000001 00000000    ; 存0

00000010 10100001    ; LDI  R1      ; 初始化为正计时模式(1=正计时,0=倒计时)
00000011 00000001    ; 存1，默认正计时

00000100 10100010    ; LDI  R2      ; 初始化暂停标志为1(1=运行,0=暂停)
00000101 00000001    ; 存1，默认运行

00000110 01010000    ; PRINT R0       ; 打印当前时间值
00000111 01000000    ;输出到OUT单元即40端口

;8259初始化配置
00001000 10100011      ; LDI  R3 13H
00001001 00010011
00001010 01011100     ;OUT R3至端口C0H
00001011 11000000

00001100 10100011      ;LDI R3 30H
00001101 00110000
00001110 01011100      ;OUT R3 至端口C1H
00001111 11000001

00010000 10100011
00010001 00000011
00010010 01011100
00010011 11000001 ;82599初始化配置

00010100 10100011
00010101 00000000
00010110 01011100
00010111 11000001    ;开放全部中断请求

00011000 10100011   ;此时重新利用R3为栈顶指针
00011001 10100000   ;初始化为A0

00011010 01110000 ;开中断 

; 主循环
00011011 10001010    ; BZC R2; 检查暂停标志
00011100 00011011    ; 实现死循环造成暂停

00011101 10000101    ; BZC R1 ;检查计时模式
00011110 11000001    ; 若为0，跳转倒计时模式     
00011111 00110000    ; JMP 正计时 ;否则跳转正计时模式
00100000 01000000


;存储中断向量信息
00110000 01100000
00110001 01110000
00110010 10000000
00110011 10010000


; 正计时逻辑
01000000 00010000    ; ADD  R0变为R0+1      ; 时间值加1
01000001 01010000    ; 输出时间值到OUT单元
01000010 01000000
01000011 00110000    ; 跳转到主循环
01000100 00011011

; 倒计时逻辑
11000001 01010000    ; 输出R0到显示设备
11000010 01000000
11000011 10000101   ;检查R1是否为0，如果为1可以跳出下方的死循环
11000100 11000111   ;R1若为0，则应继续倒计时
11000101 00110000   ;R1若为1，则应跳到主循环
11000110 00011011
11000111 10000000    ;判断R0是否为0
11001000 11000001    ;为0跳到C1实现死循环
11001001 00100000    ;不为0则减一
11001010 00110000    ;不为0跳到主循环
11001011 00011011

;暂停
01100000 10001010  ;检查暂停标志，如果已经暂停则退出中断
01100001 01100011
62 2A; 若标志为1,改为0,暂停
01100011 10010000  ;中断返回

;启动
01110000 10001010  ;检查暂停标志，如果已经暂停才修改暂停标志
01110001 01110011  ;如果不是0就执行72，中断返回
01110010 10010000  ;中断返回
01110011 00011010  ;若标志为0，改为1，启动
01110100 10010000  ;中断返回

;复位归零
10000000 10100000 ;
10000001 00000000 ;
10000010 10010000 ;中断返回

;切换计时模式
10010000 10000101 ;判断当前计时模式是否为倒计时
10010001 10010100 ;倒计时+1变为正计时
10010010 00100101 ;正计时-1变为倒计时
10010011 10010000 ;中断返回
10010100 00010101 ;
10010101 10010000

